				;file C:\Users\my asus\Desktop\Git_project\Touch-Slave\MAIN_PROGRAM_V103\MAIN_PROGRAM_V103.asm
				;1	
				;2	message '****************************************************************'
				;3	message '*PROJECT NAME :MAIN PROGRAM V103                               *'
				;4	message '*     VERSION :V103                                            *'
				;5	message '* ICE VERSION :                                                *'
				;6	message '*      DATE   :20160302                                        *'
				;7	message '*      REMARK :V103 add 33~36 key                              *'
				;8	message '****************************************************************'
				;9	                ;=INCLUDE REFERENCE FILE
				;10	                INCLUDE MAIN_PROGRAM_V103.INC
				;11	
				;12	                ;-PUBLIC LABEL
				;13	                PUBLIC  _LOAD_TKS_GLOBE_VARIES
				;14	                PUBLIC  _LOAD_HXT_REFERENCE
				;15	
				;16	CALL_   MACRO   FUNCTION
				;17	        ifdef   FUNCTION
				;18	                ifdef   PBP
				;19	                MOV     A,bank FUNCTION
				;20	                MOV     PBP,A
				;21	                endif
				;22	                CALL    FUNCTION
				;23	        endif
				;24	                ENDM
				;25	
				;26	EXTEND_FUNCTION_INITIAL MACRO
				;27	                CALL_   EXTEND_FUNCTION_1A_INITIAL
				;28	                CALL_   EXTEND_FUNCTION_1B_INITIAL
				;29	                CALL_   EXTEND_FUNCTION_1C_INITIAL
				;30	                CALL_   EXTEND_FUNCTION_1D_INITIAL
				;31	                CALL_   EXTEND_FUNCTION_1E_INITIAL
				;32	                CALL_   EXTEND_FUNCTION_1F_INITIAL
				;33	                CALL_   EXTEND_FUNCTION_1G_INITIAL
				;34	                CALL_   EXTEND_FUNCTION_1H_INITIAL
				;35	
				;36	                CALL_   EXTEND_FUNCTION_2A_INITIAL
				;37	                CALL_   EXTEND_FUNCTION_2B_INITIAL
				;38	                CALL_   EXTEND_FUNCTION_2C_INITIAL
				;39	                CALL_   EXTEND_FUNCTION_2D_INITIAL
				;40	                CALL_   EXTEND_FUNCTION_2E_INITIAL
				;41	                CALL_   EXTEND_FUNCTION_2F_INITIAL
				;42	                CALL_   EXTEND_FUNCTION_2G_INITIAL
				;43	                CALL_   EXTEND_FUNCTION_2H_INITIAL
				;44	                ENDM
				;45	
				;46	EXTEND_FUNCTION MACRO
				;47	                CALL_   EXTEND_FUNCTION_1A
				;48	                CALL_   EXTEND_FUNCTION_1B
				;49	                CALL_   EXTEND_FUNCTION_1C
				;50	                CALL_   EXTEND_FUNCTION_1D
				;51	                CALL_   EXTEND_FUNCTION_1E
				;52	                CALL_   EXTEND_FUNCTION_1F
				;53	                CALL_   EXTEND_FUNCTION_1G
				;54	                CALL_   EXTEND_FUNCTION_1H
				;55	
				;56	                CALL_   EXTEND_FUNCTION_2A
				;57	                CALL_   EXTEND_FUNCTION_2B
				;58	                CALL_   EXTEND_FUNCTION_2C
				;59	                CALL_   EXTEND_FUNCTION_2D
				;60	                CALL_   EXTEND_FUNCTION_2E
				;61	                CALL_   EXTEND_FUNCTION_2F
				;62	                CALL_   EXTEND_FUNCTION_2G
				;63	                CALL_   EXTEND_FUNCTION_2H
				;64	                ENDM
				;65	                ;==============
				;66	                ;=DATA SETCTION
				;67	                ;==============
				;68	MAIN_DATA       .SECTION          'DATA'
				;69	
				;70	ifndef  ESCpowerIDcheck
				;71	POR_ID          DB      2 DUP(?)
				;72	endif
				;73	
				;74	
				;75	
				;76	                ;==============
				;77	                ;=CODE SETCTION
				;78	                ;==============
				;79	PROGRAM_ENTRY   .SECTION  AT 000H 'CODE'
				;80	        ifdef   PBP
				;81	                CLR     PBP
				;82	                ifndef  ESCpowerIDcheck
				;83	                MOV     A,042H      ;ASCII = B
				;84	                endif
				;85	        else
				;86	                ;----------------
				;87	                ;-SET POR ID 1---
				;88	                ;----------------
				;89	                ifndef  ESCpowerIDcheck
				;90	                MOV     A,042H      ;ASCII = B
				PROGRAM_ENTRY:
				include BS83B12A-3.inc
0000	0F42	mov     a, 42H
				;91	                SNZ     TO
0001	3A8A	snz     TO
				;92	                MOV     POR_ID[0],A
0002	40C7	mov     POR_ID, a
				;93	                endif
				;94	        endif
				;95	                JMP     PROGRAM_RESET
0003	2CCE	jmp     PROGRAM_RESET
0004	0000	nop
0005	0000	nop
0006	0000	nop
0007	0000	nop
					----
					----
000A	0000	nop
000B	0000	nop
000C	0000	nop
000D	0000	nop
000E	0000	nop
000F	0000	nop
				;96	
				;97	                ;==============
				;98	                ;=MAIN PROGRAM=
				;99	                ;==============
				;100	MAIN_PROGRAM    .SECTION          'CODE'
				;101	
				;102	                ;;***********************
				;103	PROGRAM_RESET:  ;;* PROGRAM ENTRY *******
				;104	                ;;***********************
				;105	        ifdef   PBP
				;106	                ifndef  ESCpowerIDcheck
				;107	                SNZ     TO
				;108	                MOV     POR_ID[0],A
				;109	                endif
				;110	        endif
				;111	                ;----------------
				;112	                ;-SET POR ID 2---
				;113	                ;----------------
				;114	        ifndef  ESCpowerIDcheck
				;115	                MOV     A,053H      ;ASCII = S
				PROGRAM_RESET:
				MAIN_PROGRAM:
04CE	0F53	mov     a, 53H
				;116	                MOV     POR_ID[1],A
04CF	40C8	mov     POR_ID[1], a
				;117	        endif
				;118	
				;119	
				;120	                ;---------------------
				;121	                ;-MCU HARDWARE INITIAL
				;122	                ;---------------------
				;123	                MCU_HARDWARE_INITIAL
04D0	0F30	mov     a, 30H
04D1	008C	mov     CTRL, a
04D2	0F03	mov     a, 3H
04D3	008B	mov     SMOD, a
04D4	0F52	mov     a, 52H
04D5	009A	mov     WDTC, a
04D6	0F01	mov     a, 1H
04D7	0084	mov     BP, a
04D8	0F80	mov     a, 80H
04D9	24F5	call    CLEAR_RAM
04DA	1F04	clr     BP
04DB	0F60	mov     a, 60H
04DC	24F5	call    CLEAR_RAM
				;124	
				;125	                ;------------------------------
				;126	                ;-LOAD LIBRARY OPTION/THRESHOLD
				;127	                ;------------------------------
				;128	                CALL    _LOAD_TKS_GLOBE_VARIES
04DD	2502	call    _LOAD_HXT_REFERENCE
				;129	
				;130	                ;------------------------
				;131	                ;-EXTEND FUNCTION INITIAL
				;132	                ;------------------------
				;133	                EXTEND_FUNCTION_INITIAL
04DE	20A2	call    L00A2
04DF	2586	call    _USER_PROGRAM_INITIAL
				;134	
				;135	                ;;-----------------------
				;136	MAIN_LOOP:      ;;- MAIN PROGRAM LOOP ---
				;137	                ;;-----------------------
				;138	                CLR     WDT
				MAIN_LOOP:
04E0	0001	clr     wdt
				;139	                CLR     WDT1
04E1	0001	clr     wdt
				;140	                CLR     WDT2
04E2	0005	clr     wdt2
				;141	
				;142	                ;----------------
				;143	                ;-CHECK POR ID --
				;144	                ;----------------
				;145	        ifndef  ESCpowerIDcheck
				;146	                MOV     A,042H
04E3	0F42	mov     a, 42H
				;147	                XORM    A,POR_ID[0]
04E4	44C7	xorm    a, POR_ID
				;148	                MOV     A,053H
04E5	0F53	mov     a, 53H
				;149	                SZ      Z
04E6	3D0A	sz      Z
				;150	                XORM    A,POR_ID[1]
04E7	44C8	xorm    a, POR_ID[1]
				;151	                SNZ     Z
04E8	390A	snz     Z
				;152	                JMP     000H
04E9	2800	jmp     PROGRAM_ENTRY
				;153	        endif
				;154	                ;----------------------
				;155	                ;-RE INITIAL SYS. CLOCK
				;156	                ;----------------------
				;157	                RELOAD_SYS_CLOCK
04EA	0F30	mov     a, 30H
04EB	008C	mov     CTRL, a
04EC	0F03	mov     a, 3H
04ED	008B	mov     SMOD, a
				;158	                EXTEND_FUNCTION
04EE	2018	call    L0018
04EF	2597	call    _USER_PROGRAM
				;159	                ;----------------
				;160	                ;-SET POR ID  ---
				;161	                ;----------------
				;162	        ifndef  ESCpowerIDcheck
				;163	                MOV     A,042H      ;ASCII = B
04F0	0F42	mov     a, 42H
				;164	                MOV     POR_ID[0],A
04F1	40C7	mov     POR_ID, a
				;165	                MOV     A,053H      ;ASCII = S
04F2	0F53	mov     a, 53H
				;166	                MOV     POR_ID[1],A
04F3	40C8	mov     POR_ID[1], a
				;167	        endif
				;168	
				;169	                ;--------------------
				;170	WDT_WAKEUP:     ;-WDT WAKEUP FUNCTION
				;171	                ;--------------------
				;172	                if      PowerSave==1
				;173	                CALL_   _CHECK_KEY_WAKEUP
				;174	                endif
				;175	
				;176	                ifdef   PBP
				;177	                MOV     A,BANK MAIN_LOOP
				;178	                MOV     PBP,A
				;179	                endif
				;180	                JMP     MAIN_LOOP
				WDT_WAKEUP:
04F4	2CE0	jmp     MAIN_LOOP
				;181	
				;182	
				;183	
				;184	
				;185	
				;186	
				;187	
				;188	
				;189	
				;190	;;***********************************************************
				;191	;;*SUB. NAME:                                               *
				;192	;;*INPUT    :                                               *
				;193	;;*OUTPUT   :                                               *
				;194	;;*USED REG.:                                               *
				;195	;;*FUNCTION :                                               *
				;196	;;***********************************************************
				;197	CLEAR_RAM:
				;198	                MOV     MP1,A
				CLEAR_RAM:
04F5	0083	mov     MP1, a
				;199	        ifndef  ESCpowerIDcheck
				;200	            ifdef  BP
				;201	                ;-CHECK BANK
				;202	                SZ      BP
04F6	1084	sz      BP
				;203	                JMP     CLR_RAM
04F7	2CFE	jmp     CLR_RAM
				;204	            endif
				;205	                ;-CHECK POR_ID RAM
				;206	                MOV     A,OFFSET POR_ID
04F8	0FC7	mov     a, C7H
				;207	                XOR     A,MP1
04F9	0403	xor     a, MP1
				;208	                MOV     A,OFFSET POR_ID+1
04FA	0FC8	mov     a, C8H
				;209	                SNZ     Z
04FB	390A	snz     Z
				;210	                XOR     A,MP1
04FC	0403	xor     a, MP1
				;211	                SNZ     Z
04FD	390A	snz     Z
				;212	        endif
				;213	CLR_RAM:        ;-CLEAR RAM
				;214	                CLR     IAR1
				CLR_RAM:
04FE	1F02	clr     [02H]
				;215	                SIZA    MP1
04FF	1603	siza    MP1
				;216	                JMP     CLEAR_RAM
0500	2CF5	jmp     CLEAR_RAM
				;217	
				;218	                RET
0501	0003	ret
				;219	
				;220	
				;221	;;***********************************************************
				;222	;;*SUB. NAME:                                               *
				;223	;;*INPUT    :                                               *
				;224	;;*OUTPUT   :                                               *
				;225	;;*USED REG.:                                               *
				;226	;;*FUNCTION :                                               *
				;227	;;***********************************************************
				;228	_LOAD_TKS_GLOBE_VARIES:
				;229	_LOAD_HXT_REFERENCE:
				;230	                ;------------------------
				;231	                ;-SET TKS LIBRARY OPTION-
				;232	                ;------------------------
				;233	                MOV     A,GlobeOptionA
				_LOAD_HXT_REFERENCE:
				_LOAD_TKS_GLOBE_VARIES:
0502	0F87	mov     a, 87H
				;234	                MOV     _GLOBE_VARIES[0],A
0503	00E0	mov     __sima[57], a
				;235	                MOV     A,GlobeOptionB
0504	0F30	mov     a, 30H
				;236	                MOV     _GLOBE_VARIES[1],A
0505	00E1	mov     __sima[58], a
				;237	                MOV     A,GlobeOptionC
0506	0F98	mov     a, 98H
				;238	                MOV     _GLOBE_VARIES[2],A
0507	00E2	mov     __sima[59], a
				;239	
				;240	                ;--------------------------
				;241	                ;-SET TOUCH OR IO ATTRIBUTE
				;242	                ;--------------------------
				;243	                MOV     A,IO_TOUCH_ATTR&0FFH
0508	0FFF	mov     a, FFH
				;244	                MOV     _KEY_IO_SEL[0],A
0509	00FA	mov     __sima[83], a
				;245	                ;-IF OVER 2 TOUCH IP (8~16KEY)
				;246	                if      TouchKeyAmount > 8
				;247	                MOV     A,(IO_TOUCH_ATTR>>8)&0FFH
050A	0F0F	mov     a, FH
				;248	                MOV     _KEY_IO_SEL[1],A
050B	00FB	mov     __sima[84], a
				;249	                endif
				;250	                ;-IF OVER 4 TOUCH IP (17~24KEY)
				;251	                if      TouchKeyAmount > 16
				;252	                MOV     A,(IO_TOUCH_ATTR>>16)&0FFH
				;253	                MOV     _KEY_IO_SEL[2],A
				;254	                endif
				;255	                ;-IF OVER 6 TOUCH IP (25~32KEY)
				;256	                if      TouchKeyAmount > 24
				;257	                MOV     A,(IO_TOUCH_ATTR>>24)&0FFH
				;258	                MOV     _KEY_IO_SEL[3],A
				;259	                endif
				;260	
				;261	                ;-IF OVER 6 TOUCH IP (33~36KEY)
				;262	                if      TouchKeyAmount > 32
				;263	                MOV     A,IO_TOUCH_ATTR2
				;264	                MOV     _KEY_IO_SEL[4],A
				;265	                endif
				;266	
				;267	                ;------------------------
				;268	                ;-SET TOUCH KEY THRESHOLD
				;269	                ;------------------------
				;270	                ;-KEY1 THRESHOLD
				;271	                MOV     A,Key1Threshold
050C	0F0A	mov     a, AH
				;272	                MOV     _GLOBE_VARIES[3],A
050D	00E3	mov     __sima[60], a
				;273	
				;274	                if      TouchKeyAmount > 1
				;275	                ;-KEY2 THRESHOLD
				;276	                MOV     A,Key2Threshold
050E	0F0A	mov     a, AH
				;277	                MOV     _GLOBE_VARIES[4],A
050F	00E4	mov     __sima[61], a
				;278	                endif
				;279	
				;280	                if      TouchKeyAmount > 2
				;281	                ;-KEY3 THRESHOLD
				;282	                MOV     A,Key3Threshold
0510	0F0A	mov     a, AH
				;283	                MOV     _GLOBE_VARIES[5],A
0511	00E5	mov     __sima[62], a
				;284	                endif
				;285	
				;286	                if      TouchKeyAmount > 3
				;287	                ;-KEY4 THRESHOLD
				;288	                MOV     A,Key4Threshold
0512	0F0A	mov     a, AH
				;289	                MOV     _GLOBE_VARIES[6],A
0513	00E6	mov     __sima[63], a
				;290	                endif
				;291	
				;292	                if      TouchKeyAmount > 4
				;293	                ;-KEY5 THRESHOLD
				;294	                MOV     A,Key5Threshold
0514	0F0A	mov     a, AH
				;295	                MOV     _GLOBE_VARIES[7],A
0515	00E7	mov     __sima[64], a
				;296	                endif
				;297	
				;298	                if      TouchKeyAmount > 5
				;299	                ;-KEY6 THRESHOLD
				;300	                MOV     A,Key6Threshold
0516	0F0A	mov     a, AH
				;301	                MOV     _GLOBE_VARIES[8],A
0517	00E8	mov     __sima[65], a
				;302	                endif
				;303	
				;304	                if      TouchKeyAmount > 6
				;305	                ;-KEY7 THRESHOLD
				;306	                MOV     A,Key7Threshold
0518	0F0A	mov     a, AH
				;307	                MOV     _GLOBE_VARIES[9],A
0519	00E9	mov     __sima[66], a
				;308	                endif
				;309	
				;310	                if      TouchKeyAmount > 7
				;311	                ;-KEY8 THRESHOLD
				;312	                MOV     A,Key8Threshold
051A	0F0A	mov     a, AH
				;313	                MOV     _GLOBE_VARIES[10],A
051B	00EA	mov     __sima[67], a
				;314	                endif
				;315	
				;316	                if     TouchKeyAmount > 8
				;317	                ;-KEY9 THRESHOLD
				;318	                MOV     A,Key9Threshold
051C	0F0A	mov     a, AH
				;319	                MOV     _GLOBE_VARIES[11],A
051D	00EB	mov     __sima[68], a
				;320	                endif
				;321	
				;322	                if      TouchKeyAmount > 9
				;323	                ;-KEY10 THRESHOLD
				;324	                MOV     A,Key10Threshold
051E	0F0A	mov     a, AH
				;325	                MOV     _GLOBE_VARIES[12],A
051F	00EC	mov     __sima[69], a
				;326	                endif
				;327	
				;328	                if      TouchKeyAmount > 10
				;329	                ;-KEY11 THRESHOLD
				;330	                MOV     A,Key11Threshold
0520	0F0A	mov     a, AH
				;331	                MOV     _GLOBE_VARIES[13],A
0521	00ED	mov     __sima[70], a
				;332	                endif
				;333	
				;334	                if      TouchKeyAmount > 11
				;335	                ;-KEY12 THRESHOLD
				;336	                MOV     A,Key12Threshold
0522	0F0A	mov     a, AH
				;337	                MOV     _GLOBE_VARIES[14],A
0523	00EE	mov     __sima[71], a
				;338	                endif
				;339	
				;340	                if      TouchKeyAmount > 12
				;341	                ;-KEY13 THRESHOLD
				;342	                MOV     A,Key13Threshold
				;343	                MOV     _GLOBE_VARIES[15],A
				;344	                endif
				;345	
				;346	                if      TouchKeyAmount > 13
				;347	                ;-KEY14 THRESHOLD
				;348	                MOV     A,Key14Threshold
				;349	                MOV     _GLOBE_VARIES[16],A
				;350	                endif
				;351	
				;352	                if      TouchKeyAmount > 14
				;353	                ;-KEY15 THRESHOLD
				;354	                MOV     A,Key15Threshold
				;355	                MOV     _GLOBE_VARIES[17],A
				;356	                endif
				;357	
				;358	                if      TouchKeyAmount > 15
				;359	                ;-KEY16 THRESHOLD
				;360	                MOV     A,Key16Threshold
				;361	                MOV     _GLOBE_VARIES[18],A
				;362	                endif
				;363	
				;364	                if      TouchKeyAmount > 16
				;365	                ;-KEY17 THRESHOLD
				;366	                MOV     A,Key17Threshold
				;367	                MOV     _GLOBE_VARIES[19],A
				;368	                endif
				;369	
				;370	                if      TouchKeyAmount > 17
				;371	                ;-KEY18 THRESHOLD
				;372	                MOV     A,Key18Threshold
				;373	                MOV     _GLOBE_VARIES[20],A
				;374	                endif
				;375	
				;376	                if      TouchKeyAmount > 18
				;377	                ;-KEY19 THRESHOLD
				;378	                MOV     A,Key19Threshold
				;379	                MOV     _GLOBE_VARIES[21],A
				;380	                endif
				;381	
				;382	                if      TouchKeyAmount > 19
				;383	                ;-KEY20 THRESHOLD
				;384	                MOV     A,Key20Threshold
				;385	                MOV     _GLOBE_VARIES[22],A
				;386	                endif
				;387	
				;388	                if      TouchKeyAmount > 20
				;389	                ;-KEY17 THRESHOLD
				;390	                MOV     A,Key21Threshold
				;391	                MOV     _GLOBE_VARIES[23],A
				;392	                endif
				;393	
				;394	                if      TouchKeyAmount > 21
				;395	                ;-KEY18 THRESHOLD
				;396	                MOV     A,Key22Threshold
				;397	                MOV     _GLOBE_VARIES[24],A
				;398	                endif
				;399	
				;400	                if      TouchKeyAmount > 22
				;401	                ;-KEY19 THRESHOLD
				;402	                MOV     A,Key23Threshold
				;403	                MOV     _GLOBE_VARIES[25],A
				;404	                endif
				;405	
				;406	                if      TouchKeyAmount > 23
				;407	                ;-KEY20 THRESHOLD
				;408	                MOV     A,Key24Threshold
				;409	                MOV     _GLOBE_VARIES[26],A
				;410	                endif
				;411	
				;412	                if      TouchKeyAmount > 24
				;413	                ;-KEY17 THRESHOLD
				;414	                MOV     A,Key25Threshold
				;415	                MOV     _GLOBE_VARIES[27],A
				;416	                endif
				;417	
				;418	                if      TouchKeyAmount > 25
				;419	                ;-KEY18 THRESHOLD
				;420	                MOV     A,Key26Threshold
				;421	                MOV     _GLOBE_VARIES[28],A
				;422	                endif
				;423	
				;424	                if      TouchKeyAmount > 26
				;425	                ;-KEY19 THRESHOLD
				;426	                MOV     A,Key27Threshold
				;427	                MOV     _GLOBE_VARIES[29],A
				;428	                endif
				;429	
				;430	                if      TouchKeyAmount > 27
				;431	                ;-KEY20 THRESHOLD
				;432	                MOV     A,Key28Threshold
				;433	                MOV     _GLOBE_VARIES[30],A
				;434	                endif
				;435	
				;436	                if      TouchKeyAmount > 28
				;437	                ;-KEY29 THRESHOLD
				;438	                MOV     A,Key29Threshold
				;439	                MOV     _GLOBE_VARIES[31],A
				;440	                endif
				;441	
				;442	                if      TouchKeyAmount > 29
				;443	                ;-KEY30 THRESHOLD
				;444	                MOV     A,Key30Threshold
				;445	                MOV     _GLOBE_VARIES[32],A
				;446	                endif
				;447	
				;448	                if      TouchKeyAmount > 30
				;449	                ;-KEY31 THRESHOLD
				;450	                MOV     A,Key31Threshold
				;451	                MOV     _GLOBE_VARIES[33],A
				;452	                endif
				;453	
				;454	                if      TouchKeyAmount > 31
				;455	                ;-KEY32 THRESHOLD
				;456	                MOV     A,Key32Threshold
				;457	                MOV     _GLOBE_VARIES[34],A
				;458	                endif
				;459	
				;460	                if      TouchKeyAmount > 32
				;461	                ;-KEY33 THRESHOLD
				;462	                MOV     A,Key33Threshold
				;463	                MOV     _GLOBE_VARIES[35],A
				;464	                endif
				;465	
				;466	                if      TouchKeyAmount > 33
				;467	                ;-KEY34 THRESHOLD
				;468	                MOV     A,Key34Threshold
				;469	                MOV     _GLOBE_VARIES[36],A
				;470	                endif
				;471	
				;472	                if      TouchKeyAmount > 34
				;473	                ;-KEY35 THRESHOLD
				;474	                MOV     A,Key35Threshold
				;475	                MOV     _GLOBE_VARIES[37],A
				;476	                endif
				;477	
				;478	                if      TouchKeyAmount > 35
				;479	                ;-KEY36 THRESHOLD
				;480	                MOV     A,Key36Threshold
				;481	                MOV     _GLOBE_VARIES[38],A
				;482	                endif
				;483	
				;484	
				;485	                RET
0524	0003	ret
0525	B0A0	dc	0B0A0H
0526	D0C0	dc	0D0C0H
0527	F0E0	dc	0F0E0H
0528	1C28	dc	01C28H
0529	0C03	xor     a, 3H
052A	0202	sub     a, [02H]
052B	0202	sub     a, [02H]
				;486	
				;487	
				;488	
				;489	
				;490	                END
				;491	
				;492	
				;493	
				;file C:\Users\my asus\Desktop\Git_project\Touch-Slave\USER_PROGRAM\USER_PROGRAM.C
				;1	#include    "USER_PROGRAM.H"         
				;2	
				;3	#define u8		unsigned char 
				;4	#define u16		unsigned int   
				;5	#define vu8		volatile unsigned char 
				;6	#define vu16	volatile unsigned int 
				;7	
				;8	
				;9	// choose mcu
				;10	//#define  BS83B08A 	3
				;11	#define  BS83B12A 	2
				;12	//#define  BS83B16A 	1
				;13	
				;14	#if	 BS83B08A
				;15	//I2C size
				;16	#define I2C_MAXNUM		8
				;17	//page size
				;18	const u8 IC_PAGE_SIZS[]={3,8,1,2,1,2};
				;19	const u8 Version = 0x18; //硬件/件版本
				;20	// MCU_INT_CONFIG
				;21	#define MCU_INT_c  		_pac1
				;22	#define MCU_INT  		_pa1
				;23	#endif
				;24	
				;25	#if	 BS83B12A
				;26	//I2C size
				;27	#define I2C_MAXNUM		12
				;28	//page size
				;29	const u8 IC_PAGE_SIZS[]={3,12,2,2,2,2};
				;30	const u8 Version = 0x1C; //硬件/件版本
				;31	// MCU_INT_CONFIG
				;32	#define MCU_INT_c  		_pac1
				;33	#define MCU_INT  		_pa1
				;34	#endif
				;35	
				;36	#if	 BS83B16A
				;37	//I2C size
				;38	#define I2C_MAXNUM		16
				;39	//page size
				;40	const u8 IC_PAGE_SIZS[]={3,16,2,2,2,2};
				;41	const u8 Version = 0x1F; //硬件/件版本
				;42	// MCU_INT_CONFIG
				;43	#define MCU_INT_c  		_pac1
				;44	#define MCU_INT  		_pa1
				;45	#endif
				;46	
				;47	
				;48	//++++++++++++++++++++++MAIN PROGAM+++++++++++++++++++++++
				;49	#define TRUE 	1
				;50	#define FALSE 	0
				;51	#define NTH 	0x0F
				;52	#define RESET 	0x0A
				;53	
				;54	const u8 DeviceAddress = 0x28;
				;55	const u8 IC_PAGE_HEAD[]={0xA0,0xB0,0xC0,0xD0,0xE0,0xF0};
				;56	
				;57	_TKS_FLAGA_type      FLAG;
				;58	
				;59	#define FLAG_I2C_Err    FLAG.bits.b0
				;60	#define FLAG_I2C_End    FLAG.bits.b1
				;61	//#define          	FLAG.bits.b2
				;62	//#define       	FLAG.bits.b3
				;63	//#define           FLAG.bits.b4
				;64	//#define           FLAG.bits.b5
				;65	//#define           FLAG.bits.b6
				;66	
				;67	struct I2C_LIST
				;68	{
				;69	//FOR HEAD
				;70		vu8 WordAddr;		
				;71		vu8 SUM;	
				;72		vu8 TxNum;
				;73		vu8 RxNum;
				;74		vu8 CheckSum;
				;75		vu8 CheckSum_Buf;		
				;76	}I2C;
				;77	
				;78	u8 I2C_Data[I2C_MAXNUM];
				;79	
				;80	u8 MCU_INF[3];
				;81	#define MCU_STATE 		MCU_INF[0]
				;82	#define MCU_SLEEP 		MCU_INF[1]
				;83	#define MCU_WAKEUP 		MCU_INF[2]
				;84	//#define MCU_STATE 		MCU_INF[3]
				;85	//#define MCU_STATE 		MCU_INF[4]
				;86	
				;87	u8 SYS_INF[3];
				;88	#define I2C_STATE 		SYS_INF[0]
				;89	#define SYS_Version		SYS_INF[1]
				;90	//#define MCU_WAKEUP 		SYS_INF[2]
				;91	//#define MCU_STATE 		MCU_INF[3]
				;92	//#define MCU_STATE 		MCU_INF[4]
				;93	//u8 I2C_STATE;
				;94	
				;95	void DATA_LIST_UPDATA(void)
				;96	{
				;97		u8 *p;
				;98		
				;99		I2C.SUM = IC_PAGE_SIZS[I2C.WordAddr];//取量
				_DATA_LIST_UPDATA:
				_DATA_LIST_UPDATA:
052C	0F52	mov     a, 52H
052D	4340	add     a, I2C[0]
052E	0083	mov     MP1, a
052F	0F8A	mov     a, 8AH
0530	1F01	clr     MP0
0531	1381	adcm    a, MP0
0532	2724	call    L0724
0533	40C1	mov     I2C[1], a
				;100		
				;101	   	switch(I2C.WordAddr)//取的指
0534	4740	mov     a, I2C[0]
0535	40D3	mov     _DATA_LIST_UPDATA_2, a
0536	4753	mov     a, _DATA_LIST_UPDATA_2
0537	0A00	sub     a, 0H
0538	3D0A	sz      Z
0539	2D50	jmp     _L11
053A	0A01	sub     a, 1H
053B	3D0A	sz      Z
053C	2D55	jmp     _L9
053D	4753	mov     a, _DATA_LIST_UPDATA_2
053E	0A02	sub     a, 2H
053F	3D0A	sz      Z
0540	2D4A	jmp     _L5
0541	4753	mov     a, _DATA_LIST_UPDATA_2
0542	0A03	sub     a, 3H
0543	390A	snz     Z
0544	2D4F	jmp     _L10
				;102		{
				;103			case 0 :p = &GLOBE_VARIES[0];break;
				;104			case 1 :p = &GLOBE_VARIES[3];break;
				_L9:
0555	0F63	mov     a, 63H
0556	40CA	mov     rb, a
0557	0F00	mov     a, 0H
0558	40CB	mov     rc, a
				;105			case 2 :p = &KEY_IO_SEL[0];break;
				_L5:
054A	0F7A	mov     a, 7AH
054B	40CA	mov     rb, a
054C	0F00	mov     a, 0H
054D	40CB	mov     rc, a
054E	2D59	jmp     _L4
				;106			case 3 :p = &MCU_STATE;break;
0545	0FB1	mov     a, B1H
0546	40CA	mov     rb, a
0547	0F00	mov     a, 0H
0548	40CB	mov     rc, a
0549	2D59	jmp     _L4
				;107			default :p = &GLOBE_VARIES[0];I2C.SUM = 0;break;
				_L10:
054F	5F41	clr     I2C[1]
				_L11:
0550	0F60	mov     a, 60H
0551	40CA	mov     rb, a
0552	0F00	mov     a, 0H
0553	40CB	mov     rc, a
0554	2D59	jmp     _L4
				;108		}
				;109		
				;110		
				;111		for(I2C.RxNum=0;I2C.RxNum<I2C.SUM;I2C.RxNum++)
				_L4:
0559	5F43	clr     I2C[3]
055A	2D6E	jmp     _L7
056D	54C3	inc     I2C[3]
				_L7:
056E	4743	mov     a, I2C[3]
056F	4241	sub     a, I2C[1]
0570	380A	snz     C
0571	2D5B	jmp     _L8
0572	0003	ret
				;112		{	
				;113			*(p+I2C.RxNum) = I2C_Data[I2C.RxNum];	//更新|控
				_L8:
055B	0FB4	mov     a, B4H
055C	4343	add     a, I2C[3]
055D	0083	mov     MP1, a
055E	0F00	mov     a, 0H
055F	1F01	clr     MP0
0560	1381	adcm    a, MP0
0561	2724	call    L0724
0562	40C9	mov     ra, a
0563	4743	mov     a, I2C[3]
0564	434A	add     a, rb
0565	0083	mov     MP1, a
0566	1F05	clr     ACC
0567	534B	adc     a, rc
0568	0081	mov     MP0, a
0569	0701	mov     a, MP0
056A	0084	mov     BP, a
056B	4749	mov     a, ra
056C	0082	mov     [02H], a
				;114		}	
				;115		
				;116	}
				;117	
				;118	//初始化I2C
				;119	void I2C_LIST_INIT(void)
				;120	{
				;121		I2C.WordAddr = 0x00;
				_I2C_LIST_INIT:
				_I2C_LIST_INIT:
0573	5F40	clr     I2C[0]
				;122		I2C.SUM = 0;	
0574	5F41	clr     I2C[1]
				;123		I2C.RxNum = 0;
0575	5F43	clr     I2C[3]
				;124		I2C.TxNum = 0;
0576	5F42	clr     I2C[2]
				;125		I2C.CheckSum = 0;
0577	5F44	clr     I2C[4]
				;126		I2C.CheckSum_Buf = 0;
0578	5F45	clr     I2C[5]
				;127		FLAG_I2C_End = FALSE;
0579	74C6	clr     FLAG[0].1
				;128		FLAG_I2C_Err = FALSE;
057A	7446	clr     FLAG[0].0
057B	0003	ret
				;129	}
				;130	
				;131	//初始化系y
				;132	void SYS_LIST_INIT(void)
				;133	{
				;134		MCU_STATE = NTH;
				_SYS_LIST_INIT:
				_SYS_LIST_INIT:
057C	0F0F	mov     a, FH
057D	40B1	mov     MCU_INF[0], a
				;135		MCU_SLEEP = 0x4E; // 3s 
057E	0F4E	mov     a, 4EH
057F	40B2	mov     MCU_INF[1], a
				;136		
				;137		I2C_STATE = NTH;
0580	0F0F	mov     a, FH
0581	40AE	mov     SYS_INF[0], a
				;138		SYS_Version = Version;
0582	0F1C	mov     a, 1CH
0583	40AF	mov     SYS_INF[1], a
				;139		FLAG_I2C_Err = TRUE;//使用通信e`功能初始化I2C
0584	7046	set     FLAG[0].0
0585	0003	ret
				;140	}
				;141	
				;142	//==============================================
				;143	void USER_PROGRAM_INITIAL()
				;144	{	
				;145	//	_wdtc = 0b10101100;	//wdt = 1s 
				;146		
				;147		_pawu=0;		//0:禁止下降沿唤醒;   1:使能
				_USER_PROGRAM_INITIAL:
				_USER_PROGRAM_INITIAL:
0586	1F17	clr     PAWU
				;148		_papu=0;		//0:禁止上拉;         1:使能上拉
0587	1F16	clr     PAPU
				;149		
				;150		_pa=0x00;	
0588	1F14	clr     PA
				;151		_pac =0xFF;		//0:输出;      		  1:输入
0589	1F95	set     PAC
				;152			 
				;153		MCU_INT = 1;		
058A	3094	set     PA1
				;154		MCU_INT_c = 0;	
058B	3495	clr     PAC1
				;155		
				;156		
				;157	//配置定时器	
				;158	//	_tmrc = 0b00000111;//12Mhz,1/128
				;159	//	_tmr = 131;//256-156=100,1/12M*128=10.7us; 10.7us*100=1.07ms
				;160	//	_te = 1;	//定时/计数器中断控制位
				;161	//	_ton = 1;	//定时/计数器启动/停止控制位
				;162			
				;163	//配置IIC	
				;164	//	_papu0 = 1;  	//SDA
				;165	//	_papu2 = 1;  	//SCL
				;166	
				;167		_simc0 = 0b11000010;
058C	0FC2	mov     a, C2H
058D	00A4	mov     SIMC0, a
				;168		_sima = DeviceAddress;//从机地址
058E	0F28	mov     a, 28H
058F	00A7	mov     SIMC2, a
				;169		
				;170	//I2C超时配置	
				;171		_i2ctoc = 0b10111111; //64ms
0590	0FBF	mov     a, BFH
0591	00A3	mov     I2CTOC, a
				;172		_simf = 0;
0592	360F	clr     SIMF
				;173		_sime = 1;	
0593	300F	set     SIME
				;174		
				;175		SYS_LIST_INIT();
0594	257C	call    _SYS_LIST_INIT
				;176	
				;177		_emi = 1;	//总中断控制位	
0595	300E	set     EMI
0596	0003	ret
				;178	}
				;179	
				;180	//==============================================
				;181	//**********************************************
				;182	//==============================================
				;183	void USER_PROGRAM()
				;184	{
				;185	
				;186	//--------------------------------------------------------------------	
				;187		GET_KEY_BITMAP();//更新按I值
				_USER_PROGRAM:
				_USER_PROGRAM:
0597	24AE	call    L04AE
				;188		
				;189		#ifndef	BS83B08A	
				;190		
				;191		//取使能的按I值
				;192		KEY_DATA[0] = KEY_DATA[0]&KEY_IO_SEL[0] ;
0598	077A	mov     a, __sima[83]
0599	067C	and     a, __sima[85]
059A	40CA	mov     rb, a
059B	474A	mov     a, rb
059C	00FC	mov     __sima[85], a
				;193		KEY_DATA[1] = KEY_DATA[1]&KEY_IO_SEL[1] ;	
059D	077B	mov     a, __sima[84]
059E	067D	and     a, __sima[86]
059F	40C9	mov     ra, a
05A0	4749	mov     a, ra
05A1	00FD	mov     __sima[86], a
				;194		//有按I按下INT低
				;195		 if(KEY_DATA[0] || KEY_DATA[1]) 
05A2	50CA	sz      rb
05A3	2DA7	jmp     _L17
05A4	50C9	sz      ra
05A5	2DA7	jmp     _L17
05A6	2DAB	jmp     _L18
				;196		 {
				;197			MCU_INT = 0;
				_L17:
				_LI1:
05A7	3494	clr     PA1
				;198			STANDBY_TIME = 0x7F;
05A8	0F7F	mov     a, 7FH
05A9	00F8	mov     __sima[81], a
05AA	2DB1	jmp     _L19
				;199		 }
				;200	  	 else
				;201	  	 {
				;202		 	MCU_INT = 1;
				_L18:
05AB	3094	set     PA1
				;203		 	
				;204	 		if(STANDBY_TIME <= MCU_SLEEP ) // 7E - 3*1000/63 
05AC	4732	mov     a, MCU_INF[1]
05AD	0278	sub     a, __sima[81]
05AE	380A	snz     C
05AF	2DB1	jmp     _L19
				;205	  	 	{
				;206	  	 		STANDBY_TIME = 0;
05B0	1F78	clr     __sima[81]
				;207	  	 	}
				;208	 	
				;209		 		
				;210	  	 }
				;211	  	 
				;212		#endif	
				;213		
				;214		#ifdef	BS83B08A
				;215		
				;216		//取使能的按I值
				;217		KEY_DATA[0] = KEY_DATA[0]&KEY_IO_SEL[0] ;
				;218		//有按I按下INT低
				;219		 if(KEY_DATA[0]) 
				;220		 {
				;221			MCU_INT = 0;
				;222			STANDBY_TIME = 0x7F;
				;223		 }
				;224	  	 else
				;225	  	 {
				;226		 	MCU_INT = 1;
				;227		 	
				;228	 		if(STANDBY_TIME <= MCU_SLEEP ) // 7E - 3*1000/63 
				;229	  	 	{
				;230	  	 		STANDBY_TIME = 0;
				;231	  	 	}
				;232	 	
				;233		 		
				;234	  	 }
				;235		#endif		
				;236	
				;237	
				;238		
				;239		if(FLAG_I2C_Err) // 通信e`，臀I2C
				_L19:
05B1	7846	snz     FLAG[0].0
05B2	2DB4	jmp     _L20
				;240		{
				;241			I2C_LIST_INIT();
05B3	2573	call    _I2C_LIST_INIT
				;242		}
				;243	//	----------------------------------------------------------------
				;244		if(FLAG_I2C_End)				//一帧数据接收完成标志
				_L20:
05B4	78C6	snz     FLAG[0].1
05B5	2DE2	jmp     _L16
				;245		{
				;246			//⒌刂忿DQ成a	
				;247			I2C.WordAddr >>= 4;
05B6	5140	swapa   I2C[0]
05B7	0E0F	and     a, FH
05B8	40C0	mov     I2C[0], a
				;248			I2C.WordAddr -= 0x0A;
05B9	0FF6	mov     a, F6H
05BA	43C0	addm    a, I2C[0]
				;249			//接收到的有效
				;250			I2C.RxNum -= 2;
05BB	0FFE	mov     a, FEH
05BC	43C3	addm    a, I2C[3]
				;251		
				;252			//先判 a是否榭的前四 ， 且有效量是否符合大小
				;253			if((I2C.WordAddr <= 3) && (I2C.RxNum == IC_PAGE_SIZS[I2C.WordAddr])) 
05BD	0F03	mov     a, 3H
05BE	4240	sub     a, I2C[0]
05BF	380A	snz     C
05C0	2DE0	jmp     _L22
05C1	0F52	mov     a, 52H
05C2	4340	add     a, I2C[0]
05C3	0083	mov     MP1, a
05C4	0F8A	mov     a, 8AH
05C5	1F01	clr     MP0
05C6	1381	adcm    a, MP0
05C7	2724	call    L0724
05C8	40C9	mov     ra, a
05C9	4743	mov     a, I2C[3]
05CA	4249	sub     a, ra
05CB	390A	snz     Z
05CC	2DE0	jmp     _L22
				;254			{	
				;255				I2C.CheckSum_Buf =~ I2C.CheckSum_Buf;//取反党龅
05CD	4145	cpla    I2C[5]
05CE	40C5	mov     I2C[5], a
				;256				
				;257				if( I2C.CheckSum == I2C.CheckSum_Buf  )//CCheckSum
05CF	4744	mov     a, I2C[4]
05D0	4245	sub     a, I2C[5]
05D1	390A	snz     Z
05D2	2DE0	jmp     _L22
				;258				{
				;259					I2C_STATE = TRUE; //入正_苏I
05D3	0F01	mov     a, 1H
05D4	40AE	mov     SYS_INF[0], a
				;260					
				;261					DATA_LIST_UPDATA();//更新|控值
05D5	252C	call    _DATA_LIST_UPDATA
				;262					
				;263					
				;264					if(MCU_STATE == RESET)// 系yO置，如果O置臀唬tR上臀
05D6	4731	mov     a, MCU_INF[0]
05D7	0A0A	sub     a, AH
05D8	390A	snz     Z
05D9	2DDD	jmp     _L24
				;265					{
				;266						MCU_INT = 0;
05DA	3494	clr     PA1
				;267						_wdtc = 0xFF;//MCU RESET //64MS
05DB	1F9A	set     WDTC
05DC	2DE1	jmp     _L25
				;268					}
				;269					else 
				;270					{
				;271						MCU_STATE = NTH;
				_L24:
05DD	0F0F	mov     a, FH
05DE	40B1	mov     MCU_INF[0], a
05DF	2DE1	jmp     _L25
				;272					}
				;273					
				;274					
				;275					
				;276				}
				;277				else I2C_STATE = FALSE;	//入e`苏I					
				;278			}	
				;279			else I2C_STATE = FALSE;	//入e`苏I	
				_L22:
05E0	5F2E	clr     SYS_INF[0]
				;280				
				;281			FLAG_I2C_End = FALSE;
				_L25:
05E1	74C6	clr     FLAG[0].1
				_L16:
05E2	0003	ret
				;282		}	
				;283	//	----------------------------------------------------------------
				;284	}
				;285	
				;286	
				;287	
				;288	
				;289	void __attribute((interrupt(0x10))) IIC_ISR(void)
				;290	{ 
				@IIC_ISR_code .SECTION 'CODE'
0010	40CC	mov     r110, a
0011	0704	mov     a, BP
0012	40CD	mov     r210, a
0013	2DE3	jmp     _IIC_ISR
				@dummy16 .SECTION 'CODE'
					----
					----
					----
					----
				L0018:
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
				L00A2:
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
				L04AE:
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
					----
				_IIC_ISR:
				_IIC_ISR:
05E3	070A	mov     a, STATUS
05E4	40CE	mov     r310, a
05E5	0703	mov     a, MP1
05E6	40CF	mov     r410, a
05E7	0701	mov     a, MP0
05E8	40D0	mov     r510, a
				;291	 	vu8 data;	
				;292	 	
				;293	 	_simf = 0;		//清零标志位				
05E9	360F	clr     SIMF
				;294	 	if(_i2ctof)//_i2ctof=1:I2C通信超时
05EA	3B23	snz     I2CTOF
05EB	2DF0	jmp     L05F0
				;295	 	{
				;296	 		_i2ctoen = 1;
05EC	33A3	set     I2CTOEN
				;297	 		_i2ctof = 0;
05ED	3723	clr     I2CTOF
				;298	 		FLAG_I2C_Err = TRUE;
05EE	7046	set     FLAG[0].0
05EF	2F19	jmp     L0719
				;299	 	}
				;300	 	else 
				;301	 		{
				;302				if(_haas)//_haas=1:slave receive SLAVE_ADDR match							
				L05F0:
05F0	3B25	snz     HAAS
05F1	2E3A	jmp     L063A
				;303				{
				;304					//地址匹配后，判断主机x位,主机是写从机还是读从机
				;305	
				;306					if(_srw)//srw=1:slave send data to master (frist data).
05F2	3925	snz     SRW
05F3	2E31	jmp     L0631
				;307					{							
				;308						
				;309						if(I2C.WordAddr == 0x00)
05F4	50C0	sz      I2C[0]
05F5	2DFB	jmp     L05FB
				;310						{
				;311							I2C.SUM = IC_PAGE_SIZS[0];
05F6	0F03	mov     a, 3H
05F7	40C1	mov     I2C[1], a
				;312							I2C.TxNum = IC_PAGE_HEAD[0];
05F8	0FA0	mov     a, A0H
05F9	40C2	mov     I2C[2], a
				;313							I2C.CheckSum_Buf = 0;
05FA	5F45	clr     I2C[5]
				;314						}
				;315						
				;316							
				;317						switch(I2C.TxNum)
				L05FB:
05FB	4742	mov     a, I2C[2]
05FC	40D2	mov     data[1], a
05FD	4752	mov     a, data[1]
05FE	0AA0	sub     a, A0H
05FF	3D0A	sz      Z
0600	2E18	jmp     L0618
0601	0A10	sub     a, 10H
0602	3D0A	sz      Z
0603	2E1B	jmp     L061B
0604	4752	mov     a, data[1]
0605	0AC0	sub     a, C0H
0606	3D0A	sz      Z
0607	2E1E	jmp     L061E
0608	0A10	sub     a, 10H
0609	3D0A	sz      Z
060A	2E21	jmp     L0621
060B	4752	mov     a, data[1]
060C	0AE0	sub     a, E0H
060D	3D0A	sz      Z
060E	2E24	jmp     L0624
060F	4752	mov     a, data[1]
0610	0AF0	sub     a, F0H
0611	390A	snz     Z
0612	2E27	jmp     L0627
				;318						{	
				;319							case 0xA0 :data = GLOBE_VARIES[0];break;
				L0618:
0618	0760	mov     a, __sima[57]
0619	40D1	mov     data[0], a
061A	2E29	jmp     L0629
				;320							case 0xB0 :data = GLOBE_VARIES[3];;break;
				L061B:
061B	0763	mov     a, __sima[60]
061C	40D1	mov     data[0], a
061D	2E29	jmp     L0629
				;321							case 0xC0 :data = KEY_IO_SEL[0];break;
				L061E:
061E	077A	mov     a, __sima[83]
061F	40D1	mov     data[0], a
0620	2E29	jmp     L0629
				;322							case 0xD0 :data = MCU_INF[0];break;
				L0621:
0621	4731	mov     a, MCU_INF[0]
0622	40D1	mov     data[0], a
0623	2E29	jmp     L0629
				;323							case 0xE0 :data = KEY_DATA[0];break;
				L0624:
0624	077C	mov     a, __sima[85]
0625	40D1	mov     data[0], a
0626	2E29	jmp     L0629
				;324							case 0xF0 :data =  SYS_INF[0]; SYS_INF[0] = NTH;break;
0613	472E	mov     a, SYS_INF[0]
0614	40D1	mov     data[0], a
0615	0F0F	mov     a, FH
0616	40AE	mov     SYS_INF[0], a
0617	2E29	jmp     L0629
				;325							default : data = 0xAA;;break;
				L0627:
0627	0FAA	mov     a, AAH
0628	40D1	mov     data[0], a
				;326						}
				;327						_htx = 1; //_htx=1:	
				L0629:
0629	3225	set     HTX
				;328						_simd = data;
062A	4751	mov     a, data[0]
062B	00A6	mov     SIMD, a
				;329						
				;330						I2C.CheckSum_Buf += data;
062C	4751	mov     a, data[0]
062D	43C5	addm    a, I2C[5]
				;331						
				;332						I2C.SUM += I2C.TxNum;
062E	4742	mov     a, I2C[2]
062F	43C1	addm    a, I2C[1]
0630	2EC2	jmp     L06C2
				;333						
				;334						I2C.TxNum++;
				;335						if(I2C.TxNum >= I2C.SUM) 
				;336							I2C.TxNum = 0xFF;
				;337								
				;338					}else//srw=0:slave receive data for master
				;339						{	
				;340							_htx = 0;//_htx=0:
				L0631:
0631	3625	clr     HTX
				;341							_txak = 0;//_txak=0:slave enable ACK
0632	35A5	clr     TXAK
				;342							_acc = _simd;//dummy
0633	0726	mov     a, SIMD
0634	0085	mov     ACC, a
				;343							
				;344							I2C.RxNum = 0;//begin to conut
0635	5F43	clr     I2C[3]
				;345							I2C.TxNum = 0;
0636	5F42	clr     I2C[2]
				;346							I2C.SUM = 0;
0637	5F41	clr     I2C[1]
				;347							FLAG_I2C_End = FALSE;
0638	74C6	clr     FLAG[0].1
0639	2F19	jmp     L0719
				;348						} 
				;349				}
				;350				else//_haas=0:slave receive SLAVE_ADDR match,then communication data 
				;351				{	
				;352											  
				;353					if(_htx)//_htx=1:slave send data to master
				L063A:
063A	3A25	snz     HTX
063B	2EC9	jmp     L06C9
				;354					{								
				;355						if(_rxak)//_rxak=1:slave send data,then master NACK;
063C	3825	snz     RXAK
063D	2E46	jmp     L0646
				;356						{							
				;357							_htx = 0;
063E	3625	clr     HTX
				;358							_txak = 0;	
063F	35A5	clr     TXAK
				;359							_acc = _simd;//dummy
0640	0726	mov     a, SIMD
0641	0085	mov     ACC, a
				;360	
				;361							I2C.WordAddr = 0x00;
0642	5F40	clr     I2C[0]
				;362							I2C.SUM = 0;
0643	5F41	clr     I2C[1]
				;363							I2C.TxNum = 0;
0644	5F42	clr     I2C[2]
0645	2F19	jmp     L0719
				;364						}
				;365						else//_rxak=1:slave send data,then master ACK
				;366						{				
				;367							//slave continue to send data to master (second and next data).							
				;368							switch(I2C.TxNum)
				L0646:
0646	4742	mov     a, I2C[2]
0647	40D2	mov     data[1], a
0648	4752	mov     a, data[1]
0649	0AA1	sub     a, A1H
064A	3D0A	sz      Z
064B	2E89	jmp     L0689
064C	0A01	sub     a, 1H
064D	3D0A	sz      Z
064E	2E8C	jmp     L068C
064F	4752	mov     a, data[1]
0650	0AB1	sub     a, B1H
0651	3D0A	sz      Z
0652	2E8F	jmp     L068F
0653	0A01	sub     a, 1H
0654	3D0A	sz      Z
0655	2E92	jmp     L0692
0656	4752	mov     a, data[1]
0657	0AB3	sub     a, B3H
0658	3D0A	sz      Z
0659	2E95	jmp     L0695
065A	0A01	sub     a, 1H
065B	3D0A	sz      Z
065C	2E98	jmp     L0698
065D	4752	mov     a, data[1]
065E	0AB5	sub     a, B5H
065F	3D0A	sz      Z
0660	2E9B	jmp     L069B
0661	0A01	sub     a, 1H
0662	3D0A	sz      Z
0663	2E9E	jmp     L069E
0664	4752	mov     a, data[1]
0665	0AB7	sub     a, B7H
0666	3D0A	sz      Z
0667	2EA1	jmp     L06A1
0668	0A01	sub     a, 1H
0669	3D0A	sz      Z
066A	2EA4	jmp     L06A4
066B	4752	mov     a, data[1]
066C	0AB9	sub     a, B9H
066D	3D0A	sz      Z
066E	2EA7	jmp     L06A7
066F	0A01	sub     a, 1H
0670	3D0A	sz      Z
0671	2EAA	jmp     L06AA
0672	4752	mov     a, data[1]
0673	0ABB	sub     a, BBH
0674	3D0A	sz      Z
0675	2EAD	jmp     L06AD
0676	0A06	sub     a, 6H
0677	3D0A	sz      Z
0678	2EB0	jmp     L06B0
0679	4752	mov     a, data[1]
067A	0AD1	sub     a, D1H
067B	3D0A	sz      Z
067C	2EB3	jmp     L06B3
067D	0A10	sub     a, 10H
067E	3D0A	sz      Z
067F	2EB6	jmp     L06B6
0680	4752	mov     a, data[1]
0681	0AF1	sub     a, F1H
0682	3D0A	sz      Z
0683	2EB9	jmp     L06B9
0684	5652	siza    data[1]
0685	2EBC	jmp     L06BC
				;369							{
				;370			
				;371							//	case 0xA0 :data = GLOBE_VARIES[0];break;
				;372								case 0xA1 :data = GLOBE_VARIES[1];break;
				L0689:
0689	0761	mov     a, __sima[58]
068A	40D1	mov     data[0], a
068B	2EBE	jmp     L06BE
				;373								case 0xA2 :data = GLOBE_VARIES[2];break;
				L068C:
068C	0762	mov     a, __sima[59]
068D	40D1	mov     data[0], a
068E	2EBE	jmp     L06BE
				;374								
				;375							//	case 0xB0 :data = GLOBE_VARIES[3];;break;
				;376								case 0xB1 :data = GLOBE_VARIES[4];break;	
				L068F:
068F	0764	mov     a, __sima[61]
0690	40D1	mov     data[0], a
0691	2EBE	jmp     L06BE
				;377								case 0xB2 :data = GLOBE_VARIES[5];break; 
				L0692:
0692	0765	mov     a, __sima[62]
0693	40D1	mov     data[0], a
0694	2EBE	jmp     L06BE
				;378								case 0xB3 :data = GLOBE_VARIES[6];break;
				L0695:
0695	0766	mov     a, __sima[63]
0696	40D1	mov     data[0], a
0697	2EBE	jmp     L06BE
				;379								case 0xB4 :data = GLOBE_VARIES[7];break;
				L0698:
0698	0767	mov     a, __sima[64]
0699	40D1	mov     data[0], a
069A	2EBE	jmp     L06BE
				;380								case 0xB5 :data = GLOBE_VARIES[8];break;
				L069B:
069B	0768	mov     a, __sima[65]
069C	40D1	mov     data[0], a
069D	2EBE	jmp     L06BE
				;381								case 0xB6 :data = GLOBE_VARIES[9];break;
				L069E:
069E	0769	mov     a, __sima[66]
069F	40D1	mov     data[0], a
06A0	2EBE	jmp     L06BE
				;382								case 0xB7 :data = GLOBE_VARIES[10];break;
				L06A1:
06A1	076A	mov     a, __sima[67]
06A2	40D1	mov     data[0], a
06A3	2EBE	jmp     L06BE
				;383								//case 0xD0 :data = MCU_STATE[0];break;
				;384								//case 0xD1 :data = MCU_STATE[1];break;
				;385	
				;386								#ifndef	 BS83B08A	
				;387								case 0xB8 :data = GLOBE_VARIES[11];break;
				L06A4:
06A4	076B	mov     a, __sima[68]
06A5	40D1	mov     data[0], a
06A6	2EBE	jmp     L06BE
				;388								case 0xB9 :data = GLOBE_VARIES[12];break;	
				L06A7:
06A7	076C	mov     a, __sima[69]
06A8	40D1	mov     data[0], a
06A9	2EBE	jmp     L06BE
				;389								case 0xBA :data = GLOBE_VARIES[13];break;	
				L06AA:
06AA	076D	mov     a, __sima[70]
06AB	40D1	mov     data[0], a
06AC	2EBE	jmp     L06BE
				;390								case 0xBB :data = GLOBE_VARIES[14];break;
				L06AD:
06AD	076E	mov     a, __sima[71]
06AE	40D1	mov     data[0], a
06AF	2EBE	jmp     L06BE
				;391								
				;392									#ifdef	 BS83B16A
				;393									case 0xBC :data = GLOBE_VARIES[15];break;
				;394									case 0xBD :data = GLOBE_VARIES[16];break;
				;395									case 0xBE :data = GLOBE_VARIES[17];break;
				;396									case 0xBF :data = GLOBE_VARIES[18];break;
				;397									#endif
				;398								
				;399							//	case 0xC0 :data = KEY_IO_SEL[0];break;
				;400								case 0xC1 :data = KEY_IO_SEL[1];break;
				L06B0:
06B0	077B	mov     a, __sima[84]
06B1	40D1	mov     data[0], a
06B2	2EBE	jmp     L06BE
				;401								
				;402							//	case 0xD0 :data = MCU_INF[0];break;
				;403								case 0xD1 :data = MCU_INF[1];break;
				L06B3:
06B3	4732	mov     a, MCU_INF[1]
06B4	40D1	mov     data[0], a
06B5	2EBE	jmp     L06BE
				;404								
				;405							//	case 0xE0 :data = KEY_DATA[0];break;
				;406								case 0xE1 :data = KEY_DATA[1];break;
				L06B6:
06B6	077D	mov     a, __sima[86]
06B7	40D1	mov     data[0], a
06B8	2EBE	jmp     L06BE
				;407							
				;408								#endif
				;409					
				;410							//	case 0xF0 :data =SYS_INF[0];break;
				;411								case 0xF1 :data = SYS_INF[1];break;	
				L06B9:
06B9	472F	mov     a, SYS_INF[1]
06BA	40D1	mov     data[0], a
06BB	2EBE	jmp     L06BE
				;412								
				;413								
				;414								
				;415								case 0xFF :data =~I2C.CheckSum_Buf;break;	
0686	4145	cpla    I2C[5]
0687	40D1	mov     data[0], a
0688	2EBE	jmp     L06BE
				;416									
				;417								default : data = 0xAA ;break;
				L06BC:
06BC	0FAA	mov     a, AAH
06BD	40D1	mov     data[0], a
				;418							}	
				;419							
				;420							_simd = data;
				L06BE:
06BE	4751	mov     a, data[0]
06BF	00A6	mov     SIMD, a
				;421							
				;422							I2C.CheckSum_Buf += data;
06C0	4751	mov     a, data[0]
06C1	43C5	addm    a, I2C[5]
				;423								
				;424							I2C.TxNum++;
				L06C2:
06C2	54C2	inc     I2C[2]
				;425							if(I2C.TxNum >= I2C.SUM) 
06C3	4742	mov     a, I2C[2]
06C4	4241	sub     a, I2C[1]
06C5	380A	snz     C
06C6	2F19	jmp     L0719
				;426								I2C.TxNum = 0xFF;
06C7	5FC2	set     I2C[2]
06C8	2F19	jmp     L0719
				;427		
				;428						}			
				;429					}
				;430					else//_htx=0:slave receive data for master
				;431					{//for slave send data to master
				;432						data = _simd;
				L06C9:
06C9	0726	mov     a, SIMD
06CA	40D1	mov     data[0], a
				;433						_txak = 0;
06CB	35A5	clr     TXAK
				;434						
				;435						if(I2C.RxNum < 1)
06CC	50C3	sz      I2C[3]
06CD	2F04	jmp     L0704
				;436						{
				;437							//for slave send data to master
				;438							//取地址
				;439							I2C.WordAddr = data&0xf0;					
06CE	4751	mov     a, data[0]
06CF	0EF0	and     a, F0H
06D0	40C0	mov     I2C[0], a
				;440		
				;441						   	switch(I2C.WordAddr)
06D1	4740	mov     a, I2C[0]
06D2	40D2	mov     data[1], a
06D3	4752	mov     a, data[1]
06D4	0AB0	sub     a, B0H
06D5	3D0A	sz      Z
06D6	2EEA	jmp     L06EA
06D7	0A10	sub     a, 10H
06D8	3D0A	sz      Z
06D9	2EEF	jmp     L06EF
06DA	4752	mov     a, data[1]
06DB	0AD0	sub     a, D0H
06DC	3D0A	sz      Z
06DD	2EF4	jmp     L06F4
06DE	0A10	sub     a, 10H
06DF	3D0A	sz      Z
06E0	2EF9	jmp     L06F9
06E1	4752	mov     a, data[1]
06E2	0AF0	sub     a, F0H
06E3	390A	snz     Z
06E4	2EFE	jmp     L06FE
				;442							{	
				;443						//		case 0xA0 :I2C.SUM = IC_PAGE_SIZS[0];I2C.TxNum = IC_PAGE_HEAD[0];break;
				;444								case 0xB0 :I2C.SUM = IC_PAGE_SIZS[1];I2C.TxNum = IC_PAGE_HEAD[1];break;
				L06EA:
06EA	0F0C	mov     a, CH
06EB	40C1	mov     I2C[1], a
06EC	0FB0	mov     a, B0H
06ED	40C2	mov     I2C[2], a
06EE	2F02	jmp     L0702
				;445								case 0xC0 :I2C.SUM = IC_PAGE_SIZS[2];I2C.TxNum = IC_PAGE_HEAD[2];break;
				L06EF:
06EF	0F02	mov     a, 2H
06F0	40C1	mov     I2C[1], a
06F1	0FC0	mov     a, C0H
06F2	40C2	mov     I2C[2], a
06F3	2F02	jmp     L0702
				;446								case 0xD0 :I2C.SUM = IC_PAGE_SIZS[3];I2C.TxNum = IC_PAGE_HEAD[3];break;
				L06F4:
06F4	0F02	mov     a, 2H
06F5	40C1	mov     I2C[1], a
06F6	0FD0	mov     a, D0H
06F7	40C2	mov     I2C[2], a
06F8	2F02	jmp     L0702
				;447								case 0xE0 :I2C.SUM = IC_PAGE_SIZS[4];I2C.TxNum = IC_PAGE_HEAD[4];break;
				L06F9:
06F9	0F02	mov     a, 2H
06FA	40C1	mov     I2C[1], a
06FB	0FE0	mov     a, E0H
06FC	40C2	mov     I2C[2], a
06FD	2F02	jmp     L0702
				;448								case 0xF0 :I2C.SUM = IC_PAGE_SIZS[5];I2C.TxNum = IC_PAGE_HEAD[5];break;
06E5	0F02	mov     a, 2H
06E6	40C1	mov     I2C[1], a
06E7	0FF0	mov     a, F0H
06E8	40C2	mov     I2C[2], a
06E9	2F02	jmp     L0702
				;449								default   :I2C.SUM = IC_PAGE_SIZS[0];I2C.TxNum = IC_PAGE_HEAD[0];break;
				L06FE:
06FE	0F03	mov     a, 3H
06FF	40C1	mov     I2C[1], a
0700	0FA0	mov     a, A0H
0701	40C2	mov     I2C[2], a
				;450							}
				;451							I2C.CheckSum_Buf = 0;
				L0702:
0702	5F45	clr     I2C[5]
0703	2F18	jmp     L0718
				;452							I2C.RxNum++;
				;453	
				;454						}
				;455						else if(I2C.RxNum <= I2C.SUM)
				L0704:
0704	4741	mov     a, I2C[1]
0705	4243	sub     a, I2C[3]
0706	380A	snz     C
0707	2F15	jmp     L0715
				;456							 { 
				;457								I2C_Data[I2C.RxNum - 1] = data;
0708	0FB3	mov     a, B3H
0709	4343	add     a, I2C[3]
070A	0083	mov     MP1, a
070B	0F00	mov     a, 0H
070C	1F01	clr     MP0
070D	1381	adcm    a, MP0
070E	0701	mov     a, MP0
070F	0084	mov     BP, a
0710	4751	mov     a, data[0]
0711	0082	mov     [02H], a
				;458								I2C.CheckSum_Buf += data;
0712	4751	mov     a, data[0]
0713	43C5	addm    a, I2C[5]
0714	2F18	jmp     L0718
				;459								I2C.RxNum++;
				;460							 }
				;461							 else 
				;462							 {
				;463							 	I2C.CheckSum = data;
				L0715:
0715	4751	mov     a, data[0]
0716	40C4	mov     I2C[4], a
				;464							 	FLAG_I2C_End = TRUE;
0717	70C6	set     FLAG[0].1
				;465							 	I2C.RxNum++;
				L0718:
0718	54C3	inc     I2C[3]
				L0719:
0719	474D	mov     a, r210
071A	0084	mov     BP, a
071B	474E	mov     a, r310
071C	008A	mov     STATUS, a
071D	474F	mov     a, r410
071E	0083	mov     MP1, a
071F	4750	mov     a, r510
0720	0081	mov     MP0, a
0721	474C	mov     a, r110
0722	0004	reti
0723	1483	inc     MP1
				L0724:
0724	3F81	sz      MP0.7
0725	2F2A	jmp     L072A
0726	0701	mov     a, MP0
0727	0084	mov     BP, a
0728	0702	mov     a, [02H]
0729	0003	ret
				L072A:
072A	1B01	rrca    MP0
072B	0E3F	and     a, 3FH
072C	0089	mov     TBHP, a
072D	1B03	rrca    MP1
072E	0087	mov     TBLP, a
072F	1D05	tabrd   ACC
0730	3C0A	sz      C
0731	0708	mov     a, TBLH
0732	0003	ret
				;466							 }
				;467							 
				;468							
				;469					}		
				;470				}
				;471			}	
				;472	}
				;473	
				;474	
				;475	
				;476	
				;477	//void __attribute((interrupt(0x0c))) ISR_tmr0 (void)
				;478	//{		
				;479	////	LED1 = ~LED1;		
				;480	//			
				;481	//	//----------------------------------------------------
				;482	//	if(Cnt20ms > 0)//20ms 计数器
				;483	//	{				
				;484	//			Cnt20ms--;
				;485	//	}
				;486	//	else
				;487	//	{
				;488	//			Cnt20ms = 19;	
				;489	//			Flag20ms = 1;			//20ms 标志 26MS
				;490	//	}	
				;491	//}
				;492	
				;493	
				data .SECTION 'DATA'
				__acc DB DUP (?) ; __acc
				__intc0 DB DUP (?) ; __intc0
				__intc1 DB DUP (?) ; __intc1
				__pa DB DUP (?) ; __pa
				__pac DB DUP (?) ; __pac
				__papu DB DUP (?) ; __papu
				__pawu DB DUP (?) ; __pawu
				__wdtc DB DUP (?) ; __wdtc
				__i2ctoc DB DUP (?) ; __i2ctoc
				__simc0 DB DUP (?) ; __simc0
				__simc1 DB DUP (?) ; __simc1
				__simd DB DUP (?) ; __simd
				__sima DB DUP (?) ; __sima
				SYS_INF DB DUP (?) ; SYS_INF
				MCU_INF DB DUP (?) ; MCU_INF
				I2C_Data DB DUP (?) ; I2C_Data
				I2C DB DUP (?) ; I2C
				FLAG DB DUP (?) ; FLAG
				POR_ID DB DUP (?) ; POR_ID
				ra DB DUP (?)
				rb DB DUP (?)
				rc DB DUP (?)
				r110 DB DUP (?)
				r210 DB DUP (?)
				r310 DB DUP (?)
				r410 DB DUP (?)
				r510 DB DUP (?)
				data DB DUP (?) ; data
				_DATA_LIST_UPDATA_2 DB DUP (?)
